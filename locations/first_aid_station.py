from telebot.types import BotCommand
from telebot import TeleBot
import telebot
from telebot import types
import helpers
import random
import time


def enter(bot, user, all_users, location):
    basemarkup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    item1 = types.KeyboardButton("–í—ã–π—Ç–∏")
    basemarkup.add(item1)
    bot.send_photo(user["id"], open('assets/first_aid_station.png', 'rb'),
                   caption="–í—ã –∑–∞—à–ª–∏ –≤ –º–µ–¥–ø—É–Ω–∫—Ç." + '\n' + "–ó–¥–µ—Å—å –≤—ã –ª–µ—á–∏—Ç–µ—Å—å –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –Ω–∞ 10 —Ö–ø.", reply_markup=basemarkup)
    if user['health'] < user['max_health']:
        bot.send_message(
            user["id"], f"–£ –≤–∞—Å –Ω–µ–ø–æ–ª–Ω—ã–µ —Ö–ø. –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –ª–µ—á–µ–Ω–∏—è: {((user['max_health'] - user['health']) // 10 + 1) * 5} –º–∏–Ω—É—Ç.")


def leave(bot, user, all_users, location=None):
    bot.send_message(
        user["id"], "–í–æ–≤–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ –º–µ–¥–ø—É–Ω–∫—Ç, –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è!")


def events(bot, all_users, location=None):
    for user in all_users:
        print(user["id"])
        if user['health'] < user['max_health']:
            if user['max_health'] - user['health'] < 10:
                user['health'] += user['max_health'] - user['health']
            else:
                user['health'] += 10
            bot.send_message(user["id"], "–í—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ 10 –∑–¥–æ—Ä–æ–≤—å—è ‚ù§Ô∏è‚Äçü©π" +
                             '\n' + f"–í–∞—à–µ –∑–¥–æ—Ä–æ–≤—å–µ: {user['health']}/{user['max_health']}")


def message(bot, message, user, all_users, location):
    if message.text == "–í—ã–π—Ç–∏":
        helpers.move_player(bot, user, "choice")


def reset(user, location):
    pass
